Paste this to your Replit Agent (one message)
Title: Deploy now (Netlify) + revert to original UI + use Supabase only
Message:
Please ship a minimal, clean deployment and remove the sources of “Loading…” and design drift.
A) Freeze UI to original
Revert pages/components to the original Executive Dashboard layout (no “simple” temp variant).
Remove the temporary auth bypass. Route: /login → Executive Dashboard after success.
B) Use a single data source (Supabase)
Remove/hide Express API calls (feature-flag if you need, but default OFF).
Use the SQL views below for all dashboard numbers/charts.
C) SQL (run in Supabase)
-- Drop any temporary open-read policy
drop policy if exists "temp open read" on public.transactions;

-- Admin helper
create or replace function public.is_admin() returns boolean language sql as $$
  select exists (select 1 from public.profiles p where p.id = auth.uid() and p.role = 'admin');
$$;

-- RLS (transactions): admin sees all; staff sees own
alter table public.transactions enable row level security;
drop policy if exists "tx select" on public.transactions;
create policy "tx select" on public.transactions
  for select using (public.is_admin() or user_id = auth.uid());

-- Lookup tables readable
alter table public.departments enable row level security;
alter table public.insurance_providers enable row level security;
drop policy if exists "read departments" on public.departments;
create policy "read departments" on public.departments for select using (true);
drop policy if exists "read insurance providers" on public.insurance_providers;
create policy "read insurance providers" on public.insurance_providers for select using (true);

-- Dashboard views (current month)
create or replace view public.v_totals_current_month as
select
  date_trunc('month', now())::date as month_start,
  coalesce(sum(case when type='income'  then amount end),0)::numeric(14,2) as total_income,
  coalesce(sum(case when type='expense' then amount end),0)::numeric(14,2) as total_expense,
  (coalesce(sum(case when type='income'  then amount end),0)
   - coalesce(sum(case when type='expense' then amount end),0))::numeric(14,2) as net_income,
  count(*)::int as transactions_count
from public.transactions
where occurred_at >= date_trunc('month', now())::date
  and occurred_at <  (date_trunc('month', now()) + interval '1 month')::date;

create or replace view public.v_dept_totals_current_month as
select d.name as department,
       coalesce(sum(case when t.type='income' then t.amount end),0)::numeric(14,2) as income,
       coalesce(sum(case when t.type='expense' then t.amount end),0)::numeric(14,2) as expense
from public.departments d
left join public.transactions t on t.department_id = d.id
  and t.occurred_at >= date_trunc('month', now())::date
  and t.occurred_at <  (date_trunc('month', now()) + interval '1 month')::date
group by d.name;

create or replace view public.v_insurance_totals_current_month as
select coalesce(i.name,'Self-Pay') as insurance,
       coalesce(sum(case when t.type='income' then t.amount end),0)::numeric(14,2) as income
from public.transactions t
left join public.insurance_providers i on i.id = t.insurance_provider_id
where t.occurred_at >= date_trunc('month', now())::date
  and t.occurred_at <  (date_trunc('month', now()) + interval '1 month')::date
group by coalesce(i.name,'Self-Pay');
D) Frontend data calls (Supabase only)
Replace dashboard fetches with:
supabase.from('v_totals_current_month').select('*').single()
supabase.from('v_dept_totals_current_month').select('*').order('income', { ascending: false })
supabase.from('v_insurance_totals_current_month').select('*').order('income', { ascending: false })
Do not block rendering on these; if any query fails, show “No data yet” instead of an infinite spinner.
E) Netlify deploy
Add a _redirects file at repo root: /* /index.html 200
Build: npm run build → publish dist/
Netlify env vars:
VITE_SUPABASE_URL=https://cjablpgtaentlratxaul.supabase.co
VITE_SUPABASE_ANON_KEY=<same anon key>
Share the Netlify preview URL.
F) Add-Transaction form (restore exactly)
Type: dropdown (Income/Expense).
Insurance: dropdown appears for Income; selecting any provider defaults currency to USD.
Two amount inputs: Amount (SSP) and Amount (USD).
Department, Description, Patient Name, Receipt Number, Payment Method (Cash default).
Acceptance checklist
I can open Netlify URL, log in, and see the original Executive Dashboard (no spinner; either metrics or “No data yet”).
Both dashboards read from Supabase only (no Express).
Add-Transaction: insurance dropdown present, USD auto-selected when insurance chosen.
No temporary auth bypass remains.
Receipts upload will be added next (Supabase Storage + signed URLs).
After deploy, I’ll provide the receipt-upload code, monthly PDF Edge Function + Cron, and tightened RLS policies.